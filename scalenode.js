function drawblocks_onebig(f){svg.select("#blocks")&&svg.select("#blocks").remove();var d=svg.append("g").attr("id","blocks"),c=chrnames.indexOf(genetodna[f])+1;d.selectAll("rect").data(blockdata.filter(function(a){return a.i==c&&rectmap[""+a.i+a.j]!=f?!1:!0})).enter().append("rect").attr("id",function(a){return rectmap[+(""+a.i+a.j)]}).attr("width",rectwidth).attr("height",function(a){return rectmap[+(""+a.i+a.j)]==f?bigrectheight:onerectheight}).attr("fill","white").attr("fill-opacity",0).attr("stroke",
function(a){return colorarr[a.i]}).attr("stroke-opacity",1).attr("class","blocks").attr("transform",transformblock).on("click",function(a,b){var c=d3.select(this)["0"]["0"].id;timer[""+a.i+a.j]=setTimeout(function(){prevent||chrclicked(c);prevent=!1},delay)}).on("dblclick",function(a){var b=d3.select(this)["0"]["0"].id;clearTimeout(timer[""+a.i+a.j]);prevent=!0;chrdblclicked(b)}).style("stroke-width",function(a){return bw(crossedgesdata_sum[a.name])});d.append("g").attr("id","blockstext").selectAll("text").data(blockdata.filter(function(a){return a.i==
c&&rectmap[""+a.i+a.j]!=f?!1:!0})).enter().append("text").attr("transform",transformblocktext).attr("class","blocktext").attr("id",function(a){return rectmap[+(""+a.i+a.j)]+"text"}).style("text-anchor","start").style("font-size","20px").style("font-weight","700").text(function(a){return rectmap[+(""+a.i+a.j)]});d.append("g").attr("id","coltext").selectAll("text").data(chrnames).enter().append("text").attr("x",function(a,b){return onecolumnwidth/3+onecolumnwidth*b+rectwidth/2}).attr("y",function(a,
b){return heightgap/4+(onerectheight+heightgap)*(noofchr-1)+onerectheight+20}).attr("id",function(a){return a}).call(d3.behavior.drag().on("drag",dragged).on("dragstart",dragstart).on("dragend",dragend)).style("text-anchor","middle").style("font-size","22px").style("font-weight","800").attr("fill",function(a,b){return colorarr[b+1]}).text(function(a){return a})}function returnpos_onebig(f,d,c){return d3.scale.linear().domain([1,chrlengths[f]]).range([1,bigrectheight*c])(d)}
function drawfiltergenes_onebig(f,d){var c=chrnames.indexOf(genetodna[d]),a=0<c?chrnames[c-1]:null;c=c<chrnames.length-1?chrnames[c+1]:null;var b=chrtogenesneighbor[d];b=b.concat(chrtogenes[d]);for(var g=[],e=0;e<b.length;e++)genetodna[genesinfo[b[e]].Chr]!=a&&genetodna[genesinfo[b[e]].Chr]!=c&&genesinfo[b[e]].Chr!=d||g.push({Chr:genesinfo[b[e]].Chr,Gene:b[e],Start:genesinfo[b[e]].Start,End:genesinfo[b[e]].End});genetochr={};TotalGenes_displayed=g.length;text=svg.append("g").attr("id","genesg").selectAll("rect").data(g).enter().append("rect").attr("id",
function(a,b){genetochr[a.Gene]=genetodna[a.Chr];return a.Gene.replace(".","_")}).attr("transform",transform).attr("width",rectwidth-2).attr("height",function(a,b){return genesinfo[a.Gene].returnposheight*zoom.scale()}).attr("fill",function(a,b){return colorarr2[genetodna[a.Chr]]}).attr("fill-opacity",gene_opcaity).attr("class","nodes").on("mouseover",nodemouseover).on("mouseout",nodemouseout);text2=text.append("svg:title").text(function(a){return a.Gene})};